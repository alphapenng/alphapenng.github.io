<!doctype html><html lang=zh-cn itemscope itemtype=http://schema.org/WebPage><head><meta name=generator content="Hugo 0.109.0"><meta charset=utf-8><title>华为路由交换设备命令手册 · 寂寞留白</title><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><script async defer data-website-id=058488c2-18d4-498a-b683-0a898b3f6c7a src=https://data.pseudoyu.com/pseudoyu.js></script>
<script async src=https://cdn.splitbee.io/sb.js></script>
<script src=https://cdn.splitbee.io/sb-ab.js></script><meta name=description content="概述 适用设备 本命令手册主要适用于华为 NE 路由器系列型号设备及 5700 交换机系列型号设备。 命令格式 序号 格式 意义 1 粗体 命令关键字，在命令中保持不变，原样"><meta name=keywords content="geek,develop,network,programming"><link rel=canonical href=https://alphapenng.github.io/zh-cn/2022/08/03/%E5%8D%8E%E4%B8%BA%E8%B7%AF%E7%94%B1%E4%BA%A4%E6%8D%A2%E8%AE%BE%E5%A4%87%E5%91%BD%E4%BB%A4%E6%89%8B%E5%86%8C/><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css integrity=sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO crossorigin=anonymous><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.2.0/css/all.css integrity=sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ crossorigin=anonymous><link rel=stylesheet href=https://alphapenng.github.io/css/den.css><meta property="og:title" content="华为路由交换设备命令手册"><meta property="og:description" content="概述 适用设备 本命令手册主要适用于华为 NE 路由器系列型号设备及 5700 交换机系列型号设备。 命令格式 序号 格式 意义 1 粗体 命令关键字，在命令中保持不变，原样"><meta property="og:type" content="article"><meta property="og:url" content="https://alphapenng.github.io/zh-cn/2022/08/03/%E5%8D%8E%E4%B8%BA%E8%B7%AF%E7%94%B1%E4%BA%A4%E6%8D%A2%E8%AE%BE%E5%A4%87%E5%91%BD%E4%BB%A4%E6%89%8B%E5%86%8C/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-08-03T10:56:52+08:00"><meta property="article:modified_time" content="2022-08-03T10:56:52+08:00"><meta itemprop=name content="华为路由交换设备命令手册"><meta itemprop=description content="概述 适用设备 本命令手册主要适用于华为 NE 路由器系列型号设备及 5700 交换机系列型号设备。 命令格式 序号 格式 意义 1 粗体 命令关键字，在命令中保持不变，原样"><meta itemprop=datePublished content="2022-08-03T10:56:52+08:00"><meta itemprop=dateModified content="2022-08-03T10:56:52+08:00"><meta itemprop=wordCount content="6628"><meta itemprop=keywords content="network,"><meta name=twitter:card content="summary"><meta name=twitter:title content="华为路由交换设备命令手册"><meta name=twitter:description content="概述 适用设备 本命令手册主要适用于华为 NE 路由器系列型号设备及 5700 交换机系列型号设备。 命令格式 序号 格式 意义 1 粗体 命令关键字，在命令中保持不变，原样"></head><body><div class=header-container style=background:linear-gradient(rgba(0,0,0,.2),rgba(0,0,0,.2)),url(https://alphapenng.github.io/images/background.jpg);background-position:50%;background-size:cover><div class=container><nav class="header-nav navbar navbar-expand-md navbar-dark light-dark"><div class="header-logo navbar-brand"><a class=float-left href=https://alphapenng.github.io/zh-cn/><img class="mr20 header-logo-image" src=https://alphapenng.github.io/images/avatar72.png alt=logo>
alphapenng</a></div><button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarNav aria-controls=navbarNav aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="nav-menu collapse navbar-collapse" id=navbarNav><ul class=navbar-nav><li class=nav-item><a class=nav-link href=https://alphapenng.github.io/zh-cn/category/network/>网络</a></li><li class=nav-item><a class=nav-link href=https://alphapenng.github.io/zh-cn/category/develop/>开发</a></li><li class=nav-item><a class=nav-link href=https://alphapenng.github.io/zh-cn/category/programming/>编程</a></li><li class=nav-item><a class=nav-link href=https://alphapenng.github.io/zh-cn/category/geek/>折腾</a></li><li class=nav-item><a class=nav-link href=https://alphapenng.github.io/en/><i class="fas fa-globe"></i> English</a></li></ul></div></nav></div><div class="container header-wrapper"><div class=row><div class=col-lg-12><div class=header-content><h1 class=header-title>华为路由交换设备命令手册</h1><p class=header-date>作者:
alphapenng
| <span>6628 字, 14 分钟</span>
| 2022-08-03
| 分类:
<a href=https://alphapenng.github.io/zh-cn/category/network/>network</a></p><div class=header-underline></div><div class=clearfix></div><p class="float-right header-tags"><i class="fas fa-tags" aria-hidden=true></i>
<a href=https://alphapenng.github.io/zh-cn/tag/network/>network</a></p></div></div></div></div></div><main><div class="container content"><article><h2 id=概述>概述</h2><ul><li>适用设备
本命令手册主要适用于华为 NE 路由器系列型号设备及 5700 交换机系列型号设备。</li><li>命令格式</li></ul><table><thead><tr><th>序号</th><th>格式</th><th>意义</th></tr></thead><tbody><tr><td>1</td><td>粗体</td><td>命令关键字，在命令中保持不变，原样照输，采用加粗字体表示</td></tr><tr><td>2</td><td>斜体</td><td>命令参数，在命令中以实际值进行替代，采用斜体字体表示</td></tr><tr><td>3</td><td>&lt;></td><td>命令必选参数，在输入命令时必须配置该参数</td></tr><tr><td>4</td><td>[]</td><td>命令可选参数，在输入命令时根据需要配置该参数</td></tr><tr><td>5</td><td>x | y | &mldr;</td><td>表示从两个或多个选项中选取 1 个</td></tr></tbody></table><h2 id=路由器>路由器</h2><h3 id=名称>名称</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl># 采用「X_Y_Z」的形式，路由器 X 为战区名称简写，Y 为节点名称简写，Z 为设备型号，如果
</span></span><span class=line><span class=cl>存在同型号的多台设备，按 A、B、C、D 的顺序进行编号，在型号后增加编号序列
</span></span><span class=line><span class=cl><span class=p>&lt;</span>R<span class=p>&gt;</span>sys
</span></span><span class=line><span class=cl>[R]sys DB_HJ_NE20-X3
</span></span></code></pre></div><h3 id=接口>接口</h3><p>（1）环回接口（ Lookback ） 配置</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl># 配置 OSPF 协议、BGP 协议、MPLS 的 LDP 协议时必须配置相关协议的路由器 ID，且统一
</span></span><span class=line><span class=cl>采用最小环回口地址作为路由器 ID
</span></span><span class=line><span class=cl>[R]int loo0
</span></span><span class=line><span class=cl>[R-loo0]ip add 1.1.1.1 32
</span></span></code></pre></div><p>（2）GE 网口</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl># 主要配置包括介质类型、接口自协商、接口速率、流控、单 / 双工模式等基本功能
</span></span><span class=line><span class=cl># 接口缺省开启自协商功能，采用电口互连时，一般采用自协商方式互通
</span></span><span class=line><span class=cl>[R]int g0/0/0
</span></span><span class=line><span class=cl>[R-g0/0/0]port-type copper
</span></span><span class=line><span class=cl>[R-g0/0/0]ip add 10.0.0.1 24
</span></span><span class=line><span class=cl># 采用光口互连时，一般要求关闭接口自协商功能，配置固定速率互通
</span></span><span class=line><span class=cl>[R]int g0/0/1
</span></span><span class=line><span class=cl>[R-g0/0/1]port-type fiber-1000
</span></span><span class=line><span class=cl>[R-g0/0/1]undo negotiation auto
</span></span><span class=line><span class=cl>[R-g0/0/1]speed 1000
</span></span><span class=line><span class=cl>[R-g0/0/1]ip add 10.0.0.2 24
</span></span></code></pre></div><p>（3）10GE 网口</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl># 10GE 以太网接口可配置为广域网模式或局域网模式
</span></span><span class=line><span class=cl>[R]int g5/0/0
</span></span><span class=line><span class=cl>[R-g5/0/0]ip add 10.1.1.1 24
</span></span><span class=line><span class=cl>[R-g5/0/0]set transfer-mode wan
</span></span></code></pre></div><p>（4）E1 接口</p><ol><li><p>AR 系列路由器 E1-F 接口配置方式</p><ul><li><p>E1-F 接口有两种工作方式，<strong>非成帧方式</strong>和<strong>成帧方式</strong>（建议使用非成帧方式）</p><ul><li>当 E1-F 接口工作于非成帧方式时，它相当于一个不分时隙、数据带宽为 2048Kbit/s 的接口，其逻辑特性与同步串口相同，支持 PPP、HDLC 和 FR 数据链路层协议，支持 IP 网络协议</li><li>当 E1-F 接口工作于成帧方式时，线路分为 32 个时隙，对应编号为 0-31。其中 0 时隙用于传输同步信息，其余时隙可以被任意捆绑成一个通道。E1-F 接口的带宽为 n*64Kbit/s （n是指捆绑的时隙数，最大取值为 31），其逻辑特性与同步串口相同，支持 PPP、HDLC 和 FR 数据链路层协议，支持 IP 网络协议。</li></ul></li><li><p>E1-F 接口支持的时钟模式有两种：</p><ul><li>主时钟模式（内部时钟模式）：接口工作在主时钟模式时，使用芯片内部产生的时钟作为参考。</li><li>从时钟模式（线路时钟模式）：接口工作在从时钟模式时，使用线路上恢复出的时钟作为参考。
<strong>两个相连的端口必须为一主一从，时钟由主设备来提供，从设备使用线路上恢复出来时钟，保证能正确识别接收到的数据。</strong></li></ul></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl># AR 系列路由器基本配置
</span></span><span class=line><span class=cl>[R]display device //查看 E1T1 接口卡的槽位号，是否在位以及状态是否正常
</span></span><span class=line><span class=cl>[R]display workmode [slot 槽位 id ｜all] //查看 E1T1 接口卡的工作模式
</span></span><span class=line><span class=cl>[R]set workmode slot <span class=p>&lt;</span>slot-id<span class=p>&gt;</span> e1-f //配置 E1T1 接口卡工作在 E1-F 模式，默认
</span></span><span class=line><span class=cl>就是该模式
</span></span><span class=line><span class=cl>[R]int s2/0/0
</span></span><span class=line><span class=cl>[R-s2/0/0]fe1 unframed //配置为非成帧方式，默认成帧方式(要配）
</span></span><span class=line><span class=cl>[R-s2/0/0]fe1 line-termination [75-ohm <span class=p>|</span> 120-ohm] //配置E1-F 接口所连接的
</span></span><span class=line><span class=cl>线缆类型，默认 120-ohm（不要配）
</span></span><span class=line><span class=cl>[R-s2/0/0]fe1 clock [master <span class=p>|</span> slave <span class=p>|</span> system] //配置 E1-F 接口的时钟方式，
</span></span><span class=line><span class=cl>默认为 slave（要配）
</span></span><span class=line><span class=cl>[R-s2/0/0]crc [16 <span class=p>|</span> 32 <span class=p>|</span> none ] 配置接口的 CRC 校验模式，默认 16 位 CRC 校验，
</span></span><span class=line><span class=cl>建议修改为 32 位（要配）
</span></span><span class=line><span class=cl># 多个 E1 接口捆绑
</span></span><span class=line><span class=cl>[R]interface mp-group0/0/0
</span></span><span class=line><span class=cl>[R-mp-group0/0/0]ip add 1.1.13.1 24
</span></span><span class=line><span class=cl>[R-mp-group0/0/0]interface serial 2/0/0
</span></span><span class=line><span class=cl>[R-serial2/0/0]ppp mp-group 0/0/0
</span></span><span class=line><span class=cl>[R-serial2/0/0]interface serial 2/0/1
</span></span><span class=line><span class=cl>[R-serial2/0/1]ppp mp-group 0/0/0
</span></span></code></pre></div></li><li><p>NE 系列路由器 CPOS 接口和 E1 接口配置方式</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl># NE20E 路由器 CPOS 接口配置
</span></span><span class=line><span class=cl># 将 CPOS 接口和其通道化出来的 E1 接口配置为主时钟模式
</span></span><span class=line><span class=cl><span class=p>&lt;</span>NE210E<span class=p>&gt;</span>system-view
</span></span><span class=line><span class=cl>[NE210E]controller cpos 1/0/0
</span></span><span class=line><span class=cl>[NE210E-Cpos1/0/0]clock master
</span></span><span class=line><span class=cl>[NE210E-Cpos1/0/0]e1 1 unframed
</span></span><span class=line><span class=cl>[NE210E-Cpos1/0/0]e1 1 set clock master
</span></span><span class=line><span class=cl>[NE210E-Cpos1/0/0]e1 2 unframed
</span></span><span class=line><span class=cl>[NE210E-Cpos1/0/0]e1 2 set clock master
</span></span><span class=line><span class=cl># 创建 Mp-group 接口，配置 IP 地址
</span></span><span class=line><span class=cl>[NE210E]interface mp-group 0/0/0
</span></span><span class=line><span class=cl>[NE210E-Mp-group0/0/0]ip address 10.1.1.1 30
</span></span><span class=line><span class=cl>[NE210E-Mp-group0/0/0]quit
</span></span><span class=line><span class=cl># 将串口 Serial1/0/0/1:0 加入 Mp-group 接口
</span></span><span class=line><span class=cl>[NE210E]interface serial1/0/0/1:0
</span></span><span class=line><span class=cl>[NE210E-Serial1/0/0/1:0]link-protocol ppp
</span></span><span class=line><span class=cl>[NE210E-Serial1/0/0/1:0]ppp mp mp-group0/0/0
</span></span><span class=line><span class=cl>[NE210E-Serial1/0/0/1:0]quit
</span></span><span class=line><span class=cl># 将串口 Serial1/0/0/2:0 加入 Mp-group 接口
</span></span><span class=line><span class=cl>[NE210E]interface serial1/0/0/2:0
</span></span><span class=line><span class=cl>[NE210E-Serial1/0/0/2:0]link-protocol ppp
</span></span><span class=line><span class=cl>[NE210E-Serial1/0/0/2:0]ppp mp mp-group0/0/0
</span></span><span class=line><span class=cl>[NE210E-Serial1/0/0/2:0]quit
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl># NE20 路由器 E1 接口配置
</span></span><span class=line><span class=cl># 配置 E1 接口的工作模式
</span></span><span class=line><span class=cl><span class=p>&lt;</span>NE20<span class=p>&gt;</span>system-view
</span></span><span class=line><span class=cl>[NE20]controller e1 1/0/0
</span></span><span class=line><span class=cl>[NE20-E1 1/0/0]using e1
</span></span><span class=line><span class=cl>[NE20-E1 1/0/0]quit
</span></span><span class=line><span class=cl>[NE20]controller e1 1/0/1
</span></span><span class=line><span class=cl>[NE20-E1 1/0/1]using e1
</span></span><span class=line><span class=cl>[NE20-E1 1/0/1]quit
</span></span><span class=line><span class=cl># 创建 Mp-group 接口，配置相应的 IP 地址
</span></span><span class=line><span class=cl>[NE20]interface mp-group 0/0/0
</span></span><span class=line><span class=cl>[NE20-mp-group0/0/0]ip address 10.1.1.2 30
</span></span><span class=line><span class=cl>[NE20-mp-group0/0/0]quit
</span></span><span class=line><span class=cl># 配置 E1 接口通道化出来的 Serial 接口
</span></span><span class=line><span class=cl># 配置串口 Serial1/0/0:0
</span></span><span class=line><span class=cl>[NE20]interface serial1/0/0:0
</span></span><span class=line><span class=cl>[NE20-Serial1/0/0:0]link-protocol ppp
</span></span><span class=line><span class=cl>[NE20-Serial1/0/0:0]ppp mp mp-group0/0/0
</span></span><span class=line><span class=cl>[NE20-Serial1/0/0:0]quit
</span></span><span class=line><span class=cl>[NE20]interface serial1/0/1:0
</span></span><span class=line><span class=cl>[NE20-Serial1/0/1:0]link-protocol ppp
</span></span><span class=line><span class=cl>[NE20-Serial1/0/1:0]ppp mp mp-group0/0/0
</span></span><span class=line><span class=cl>[NE20-Serial1/0/1:0]quit
</span></span><span class=line><span class=cl># 验证配置
</span></span><span class=line><span class=cl>[NE20E]dis interface serial 1/0/0/1:0
</span></span><span class=line><span class=cl>[NE20E]dis interface mp-group 0/0/0
</span></span><span class=line><span class=cl>[NE20E]dis ppp mp
</span></span></code></pre></div></li></ol><p>（5）Pos 口</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl>[R]int pos2/0/0
</span></span><span class=line><span class=cl>[R-pos2/0/0]link-protocol [ppp <span class=p>|</span> hdlc <span class=p>|</span> fr] // 默认 ppp
</span></span><span class=line><span class=cl>[R-pos2/0/0]crc [16 <span class=p>|</span> 32] // 默认 32
</span></span><span class=line><span class=cl>[R-pos2/0/0]clock [slave <span class=p>|</span> master] // 默认 master，一般不需要更改
</span></span><span class=line><span class=cl>[R-pos2/0/0]frame-format [sdh <span class=p>|</span> sonet] // 默认 sdh，一般不需要更改
</span></span><span class=line><span class=cl>[R-pos2/0/0]scramble // 默认加扰，可以使用 undo scramble 命令取消
</span></span></code></pre></div><h3 id=认证>认证</h3><p>（1）串口登录密码认证</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl># 控制口登录密码认证
</span></span><span class=line><span class=cl>[R]user-interface con 0
</span></span><span class=line><span class=cl>[R-ui-console0]authentication-mode password
</span></span><span class=line><span class=cl>[R-ui-console0]set authentication password cipher huawei@123
</span></span></code></pre></div><p>（2）aaa 认证</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl># 控制口登录 aaa 认证
</span></span><span class=line><span class=cl>[R]user-interface con 0
</span></span><span class=line><span class=cl>[R-ui-con0]authentication-mode aaa
</span></span><span class=line><span class=cl>[R]aaa
</span></span><span class=line><span class=cl>[R-aaa]local-user admin123 password cipher huawei@123
</span></span><span class=line><span class=cl>[R-aaa]local-user admin123 service-type terminal
</span></span><span class=line><span class=cl>[R-aaa]local-user admin123 privilege level 15
</span></span><span class=line><span class=cl># 配置用户在 10 分钟内错误连接次数为 3 次，3 次输入错误密码，锁定用户并在 10 分钟后
</span></span><span class=line><span class=cl>解锁
</span></span><span class=line><span class=cl>[R-aaa]user-block failed-times 3 period 10
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl># 虚拟终端登录 aaa 认证
</span></span><span class=line><span class=cl>[R]user-interface vty 0 4
</span></span><span class=line><span class=cl>[R-ui-vty0-4]authentication-mode aaa
</span></span><span class=line><span class=cl>[R-ui-vty0-4]protocol inbound all ( 允许 telnet 和 ssh 登录）
</span></span><span class=line><span class=cl>[R]aaa
</span></span><span class=line><span class=cl># telnet 用户
</span></span><span class=line><span class=cl>[R-aaa]local-user tel123 password cipher huawei@123
</span></span><span class=line><span class=cl>[R-aaa]local-user tel123 privilege level 15
</span></span><span class=line><span class=cl>[R-aaa]local-user tel123 service-type telnet
</span></span><span class=line><span class=cl># ftp 用户
</span></span><span class=line><span class=cl>[R-aaa]local-user ftp123 password cipher huawei@123
</span></span><span class=line><span class=cl>[R-aaa]local-user ftp123 privilege level 15
</span></span><span class=line><span class=cl>[R-aaa]local-user ftp123 service-type ftp
</span></span><span class=line><span class=cl>[R-aaa]local-user ftp123 ftp-directory flash:
</span></span><span class=line><span class=cl># stelnet 和 sftp 用户
</span></span><span class=line><span class=cl>[R-aaa]local-user ssh123 password cipher huawei@123
</span></span><span class=line><span class=cl>[R-aaa]local-user ssh123 privilege level 15
</span></span><span class=line><span class=cl>[R-aaa]local-user ssh123 service-type ssh
</span></span><span class=line><span class=cl>[R]ssh user ssh123 authentication-mode password
</span></span><span class=line><span class=cl>[R]ssh user ssh123 service-type stelent sftp
</span></span><span class=line><span class=cl>[R]ssh user ssh123 sftp-directory sftp
</span></span><span class=line><span class=cl># 开启相应服务器
</span></span><span class=line><span class=cl>[R]telnet server enable
</span></span><span class=line><span class=cl>[R]ftp server enable
</span></span><span class=line><span class=cl>[R]stelnet server enable
</span></span><span class=line><span class=cl>[R]sftp server enable
</span></span><span class=line><span class=cl># ssh 用户（包括 stelnet 和 sftp ) 生成本地密钥对
</span></span><span class=line><span class=cl>[R]rsa local-key-pair create
</span></span></code></pre></div><p>（3）链路认证（只有 PPP 协议需要配置）</p><ul><li>PAP 认证(此为单项认证配置，双项认证要求路由器再添加对端的配置命令即可）</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl># 路由器 1
</span></span><span class=line><span class=cl>[R1] aaa
</span></span><span class=line><span class=cl>[R1-aaa]local-user admin1 password cipher huawei@123
</span></span><span class=line><span class=cl>[R1-aaa]local-user admin1 service-type ppp
</span></span><span class=line><span class=cl>[R1-aaa]quit
</span></span><span class=line><span class=cl>[R1]int serial 1/0/0:0
</span></span><span class=line><span class=cl>[R1-Serial1/0/0:0]ppp authentication-mode pap
</span></span><span class=line><span class=cl>[R1-Serial1/0/0:0]quit
</span></span><span class=line><span class=cl># 路由器 2
</span></span><span class=line><span class=cl>[R2]int serial1/0/1:0
</span></span><span class=line><span class=cl>[R2-Serial1/0/1:0]ppp pap local-user admin1 password cipher huawei@123
</span></span></code></pre></div><ul><li>CHAP 认证</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl># 路由器 1
</span></span><span class=line><span class=cl>[R1]aaa
</span></span><span class=line><span class=cl>[R1-aaa]local-user admin1 password cipher huawei@123
</span></span><span class=line><span class=cl>[R1-aaa]local-user admin1 service-type ppp
</span></span><span class=line><span class=cl>[R1-aaa]quit
</span></span><span class=line><span class=cl>[R1]int pos2/0/1
</span></span><span class=line><span class=cl>[R1-pos2/0/1]ppp authentication-mode chap
</span></span><span class=line><span class=cl>[R1-pos2/0/1]q
</span></span><span class=line><span class=cl># 路由器 2
</span></span><span class=line><span class=cl>[R2]int pos2/0/1
</span></span><span class=line><span class=cl>[R2-pos2/0/1]ppp chap user admin1
</span></span><span class=line><span class=cl>[R2-pos2/0/1]ppp chap password cipher huawei@123
</span></span><span class=line><span class=cl>[R2-pos2/0/1]q
</span></span></code></pre></div><h3 id=ospf>OSPF</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl># 基本配置
</span></span><span class=line><span class=cl>[R]ospf 1 router-id 1.1.1.1
</span></span><span class=line><span class=cl># 修改 OSPF 优先级（此参数建议谨慎修改，会影响全局路由）
</span></span><span class=line><span class=cl>[R-ospf-1]preference 30
</span></span><span class=line><span class=cl># 修改 OSPF ASE 优先级（此参数建议谨慎修改，会影响全局路由）
</span></span><span class=line><span class=cl>[R-ospf-1]preference ase 30
</span></span><span class=line><span class=cl># 修改 OSPF 协议计算路由参考带宽 10000Mbit/s
</span></span><span class=line><span class=cl>[R-ospf-1]bandwidth-reference 10000
</span></span><span class=line><span class=cl># OSPF 区域配置
</span></span><span class=line><span class=cl>[R-ospf-1]area 0
</span></span><span class=line><span class=cl># 配置OSPF 区域认证
</span></span><span class=line><span class=cl>[R-ospf-1-area-0.0.0.0]authentication-mode md5 1 huawei
</span></span><span class=line><span class=cl># 宣告路由
</span></span><span class=line><span class=cl>[R-ospf-1-area-0.0.0.0]network 1.1.1.1 0.0.0.0
</span></span><span class=line><span class=cl>[R-ospf-1-area-0.0.0.0]network 5.1.2.4 0.0.0.3  
</span></span><span class=line><span class=cl>[R-ospf-1-area-0.0.0.0]area 1
</span></span><span class=line><span class=cl>[R-ospf-1-area-0.0.0.1]nssa //配置 OSPF nssa 区域
</span></span><span class=line><span class=cl># 在区域 1 中配置区域间路由聚合
</span></span><span class=line><span class=cl>[R-ospf-1-area-0.0.0.1]network 20.0.1.0 0.0.0.255
</span></span><span class=line><span class=cl>[R-ospf-1-area-0.0.0.1]network 20.0.2.0 0.0.0.255
</span></span><span class=line><span class=cl>[R-ospf-1-area-0.0.0.1]network 20.0.3.0 0.0.0.255
</span></span><span class=line><span class=cl>[R-ospf-1-area-0.0.0.1]abr-summary 20.0.0.0 255.255.252.0
</span></span><span class=line><span class=cl># 通过路由策略引入路由
</span></span><span class=line><span class=cl>[R]acl 2000
</span></span><span class=line><span class=cl>[R-acl-basic-2000]rule permit source 192.168.1.0 0.0.0.255
</span></span><span class=line><span class=cl>[R-acl-basic-2000]route-policy rp1 permit node 1
</span></span><span class=line><span class=cl>[R-route-policy]if-match acl 2000
</span></span><span class=line><span class=cl>[R-route-policy]ospf 1
</span></span><span class=line><span class=cl>[R-ospf-1]import-route direct route-policy rp1 
</span></span><span class=line><span class=cl>#  OSPF 设置接口参数
</span></span><span class=line><span class=cl>[R]int g0/0/0
</span></span><span class=line><span class=cl>[R-g0/0/0]ospf authentication-mode md5 1 huawei //配置 OSPF 接口认证
</span></span><span class=line><span class=cl>[R-g0/0/0]ospf cost 20000 //配置 OSPF 接口开销
</span></span></code></pre></div><h3 id=bgp>BGP</h3><p>（1）BGP 基本配置</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl>[R]bgp 100
</span></span><span class=line><span class=cl># 修改 bgp 优先级，三个参数依次为 ebgp 外部路由协议优先级，ibgp 内部路由协议优先级
</span></span><span class=line><span class=cl>以及 bgp 本地路由协议优先级——本地路由是指通过聚合命令（summary automatic 自动聚合
</span></span><span class=line><span class=cl>和 aggregate 手动聚合）所聚合的路由
</span></span><span class=line><span class=cl>[R-bgp]perference 10 100 255 // 此参数建议谨慎修改，会影响全局路由
</span></span><span class=line><span class=cl>[R-bgp]undo synchronization // 关闭 bgp 同步
</span></span><span class=line><span class=cl>[R-bgp]undo summary automatic // 关闭自动归纳功能（默认关闭）
</span></span><span class=line><span class=cl>[R-bgp]router-id  6.0.0.11
</span></span><span class=line><span class=cl>[R-bgp]compare-different-as-med // 只有在比较不同 AS 邻居路由器的 MED 属性时才
</span></span><span class=line><span class=cl>开启
</span></span><span class=line><span class=cl>[R-bgp]peer 1.1.1.5 as-number 1 // 指向 EBGP 邻居
</span></span><span class=line><span class=cl>[R-bgp]peer 1.1.1.5 password cipher huawei@123 // 邻居认证
</span></span><span class=line><span class=cl>[R-bgp]peer 5.192.0.12 as-number 11 // 指向 IBGP 邻居
</span></span><span class=line><span class=cl>[R-bgp]peer 5.192.0.12 connect-interface loopback 0 // 指定用环回口建立 
</span></span><span class=line><span class=cl>IBGP 邻居
</span></span><span class=line><span class=cl>[R-bgp]peer 5.192.0.12 next-hop-local // 更改 IBGP 邻居获得的路由下一跳指向
</span></span><span class=line><span class=cl>自己
</span></span><span class=line><span class=cl><span class=p>&lt;</span>R<span class=p>&gt;</span>reset bgp all // 重启 bgp 进程
</span></span></code></pre></div><p>（2）BGP 业务路由引入</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl>[R]bgp 100
</span></span><span class=line><span class=cl>[R-bgp]network 10.1.4.4 24
</span></span><span class=line><span class=cl># network 发布的路由，需要在路由表中有一条完全匹配的路由，否则无法发布，若无匹配路由，
</span></span><span class=line><span class=cl>则需手动配置一条静态路由指向 null 0，如
</span></span><span class=line><span class=cl>[R-bgp]network 6.0.0.0 8 
</span></span><span class=line><span class=cl>[R-bgp]ip route-static 6.0.0.0 255.0.0.0 null 0
</span></span></code></pre></div><h3 id=vpnmpls-vpn>VPN(MPLS VPN)</h3><p>（1） MPLS 基本配置</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl>[R]mpls lsr-id loopback 0
</span></span><span class=line><span class=cl>[R]mpls
</span></span><span class=line><span class=cl>[R-mpls]mpls ldp
</span></span><span class=line><span class=cl>[R-mpls-ldp]int pos 1/0/1
</span></span><span class=line><span class=cl>[R-pos1/0/1]mpls
</span></span><span class=line><span class=cl>[R-pos1/0/1]mpls ldp
</span></span><span class=line><span class=cl>[R-pos1/0/1]mtu 1500 // 可选配
</span></span><span class=line><span class=cl>[R-pos1/0/1]mpls mtu 1520 // 可选配
</span></span></code></pre></div><p>（2）创建 VPN 实例并与接口进行绑定</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl>[R]ip vpn-instance vpna
</span></span><span class=line><span class=cl>[R-vpn-instance-vpna]ipv4-family
</span></span><span class=line><span class=cl>[R-vpn-instance-vpna-af-ipv4]route-distinguisher 300:1
</span></span><span class=line><span class=cl>[R-vpn-instance-vpna-af-ipv4]vpn-target 100:1
</span></span><span class=line><span class=cl>[R]int g2/0/0
</span></span><span class=line><span class=cl>[R-g2/0/0]ip binding vpn-instance vpna
</span></span><span class=line><span class=cl>[R-g2/0/0]ip add 192.168.31.1 24
</span></span></code></pre></div><p>（3）配置路由协议实现 VPN 实例内路由互通</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl># OSPF 协议
</span></span><span class=line><span class=cl>[R]ospf 2 vpn-instance vpna
</span></span><span class=line><span class=cl>[R-ospf-2]area 0
</span></span><span class=line><span class=cl>[R-ospf-2-area-0.0.0.0]network 192.168.31.0 0.0.0.255
</span></span><span class=line><span class=cl>[R-ospf-2-area-0.0.0.0]import-route bgp  //如果bgp路由太大，请使用路由策略过滤
</span></span><span class=line><span class=cl>想要引入的路由
</span></span><span class=line><span class=cl># 静态路由协议
</span></span><span class=line><span class=cl>[R]ip route-static vpn-instance vpna 172.16.6.0 24 
</span></span><span class=line><span class=cl>192.168.52.5
</span></span></code></pre></div><p>（4）配置 MP-BGP</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl>[R]bgp 100
</span></span><span class=line><span class=cl>[R-bgp]ipv4-family vpnv4
</span></span><span class=line><span class=cl>[R-bgp-af-vpnv4]peer 12.0.0.2 enable
</span></span><span class=line><span class=cl>[R-bgp-af-vpnv4]peer 12.0.0.2 advertise-community
</span></span><span class=line><span class=cl>[R-bgp-af-vpnv4]quit
</span></span><span class=line><span class=cl>[R-bgp]ipv4-family vpn-instance vpna
</span></span><span class=line><span class=cl>[R-bgp-vpna]network 172.16.5.0 24 //宣告路由，用 network 和 import-route 
</span></span><span class=line><span class=cl>命令都可以
</span></span></code></pre></div><h3 id=组播>组播</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl># 全局开启组播
</span></span><span class=line><span class=cl>[R]multicast routing-enable
</span></span><span class=line><span class=cl># 接口加入组播
</span></span><span class=line><span class=cl>[R-g0/0/0]int loo0
</span></span><span class=line><span class=cl>[R-lo0]pim sm
</span></span><span class=line><span class=cl>[R]int g0/0/0
</span></span><span class=line><span class=cl>[R-g0/0/0]pim sm
</span></span><span class=line><span class=cl># 下游有接收组播组成员的接口还需开启 igmp
</span></span><span class=line><span class=cl>[R-g0/0/0]igmp enable
</span></span><span class=line><span class=cl># 配置 rp（静态 rp 需在每台启用组播的设备上配置，动态 rp 配置一次即可）
</span></span><span class=line><span class=cl>[R]acl number 2000
</span></span><span class=line><span class=cl>[R-acl-basic-2000]rule permit source 225.0.0.0 0.255.255.255
</span></span><span class=line><span class=cl>[R-acl-basic-2000]rule permit source 226.0.0.0 0.255.255.255
</span></span><span class=line><span class=cl>[R-acl-basic-2000]rule permit source 227.0.0.0 0.255.255.255
</span></span><span class=line><span class=cl>[R-acl-basic-2000]rule deny source any
</span></span><span class=line><span class=cl>[R]pim 
</span></span><span class=line><span class=cl>[R]c-bsr lo0 priority 100// 动态 rp 需配置候选 bsr，优先级越大越优先，默认为0
</span></span><span class=line><span class=cl># 使用 group-policy <span class=p>&lt;</span>acl 编号 <span class=p>&gt;</span> 命令配置 RP 允许接受的组播地址范围
</span></span><span class=line><span class=cl>[R]c-rp lo0 group-policy 2000 priority 100 // 动态 rp 需配置候选 rp，优先级
</span></span><span class=line><span class=cl>越小越优先，默认为 0 
</span></span><span class=line><span class=cl># 在 AS 边界路由器上配置阻断 Bootstrap 报文传递到对端 AS 中
</span></span><span class=line><span class=cl>[R]int g0/0/0
</span></span><span class=line><span class=cl>[R-g0/0/0]pim bsr-boundary
</span></span><span class=line><span class=cl># 配置各 AS 域内 rp 之间的 msdp（组播源发现协议）互通
</span></span><span class=line><span class=cl>[R]msdp
</span></span><span class=line><span class=cl>[R-msdp]peer 12.0.0.2 connect-interface g0/0/0
</span></span><span class=line><span class=cl># 缺省情况下，RP 收到的所有 SA 消息都转发给 MSDP 邻居，但对于那些只用于本自治系统
</span></span><span class=line><span class=cl>使用的组播地址信息，可以使用 SA 过滤器对发送给 MSDP 邻居的 SA 消息进行过滤
</span></span><span class=line><span class=cl># 假设 AS 内部的组播地址为 231.0.0.0-238.0.0.0，则需对这些组播地址进行限制，而对
</span></span><span class=line><span class=cl>全网范围的组播地址则不加限制
</span></span><span class=line><span class=cl>[R]acl number 3000
</span></span><span class=line><span class=cl>[R-acl-adv-3000]rule deny ip source any destination 231.0.0.0 0.255.255.255
</span></span><span class=line><span class=cl>[R-acl-adv-3000]rule deny ip source any destination 232.0.0.0 0.255.255.255
</span></span><span class=line><span class=cl>[R-acl-adv-3000]rule deny ip source any destination 233.0.0.0 0.255.255.255
</span></span><span class=line><span class=cl>[R-acl-adv-3000]rule deny ip source any destination 234.0.0.0 0.255.255.255
</span></span><span class=line><span class=cl>[R-acl-adv-3000]rule deny ip source any destination 235.0.0.0 0.255.255.255
</span></span><span class=line><span class=cl>[R-acl-adv-3000]rule deny ip source any destination 236.0.0.0 0.255.255.255
</span></span><span class=line><span class=cl>[R-acl-adv-3000]rule deny ip source any destination 237.0.0.0 0.255.255.255
</span></span><span class=line><span class=cl>[R-acl-adv-3000]rule deny ip source any destination 238.0.0.0 0.255.255.255
</span></span><span class=line><span class=cl>[R-acl-adv-3000]rule permit ip source any destination any
</span></span><span class=line><span class=cl>[R]msdp
</span></span><span class=line><span class=cl>[R-msdp]peer 12.0.0.2 sa-policy export acl 3000
</span></span></code></pre></div><h3 id=配置文件备份>配置文件备份</h3><p>（1）复制粘贴方式
（2）ftp 导出方式
（3）sftp 导出方式</p><h2 id=交换机>交换机</h2><h3 id=名称-1>名称</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl># 采用「X_Y_Z」的形式，交换机 X 为节点或指挥所名称简写，Y 为网络业务区名称简写，Z 为
</span></span><span class=line><span class=cl>设备型号
</span></span><span class=line><span class=cl><span class=p>&lt;</span>S<span class=p>&gt;</span>sys
</span></span><span class=line><span class=cl>[S]sys 401GC_CSFW_S5700 (401 工程传输服务区 S5700 交换机）
</span></span></code></pre></div><h3 id=接口-1>接口</h3><p>（1）Vlanif 接口</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl>[S]int vlanif 1
</span></span><span class=line><span class=cl>[S-vlanif1]ip add 10.1.1.1 255.255.255.0
</span></span></code></pre></div><p>（2） Eth-trunk 接口</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl>[S]int eth-trunk 1
</span></span><span class=line><span class=cl>[S-eth-trunk1]mode manual load-balance //默认即为手工负载分担模式，此条命令可以
</span></span><span class=line><span class=cl>不配
</span></span><span class=line><span class=cl>[S-eth-trunk1]trunkport g 0/0/1 to 0/0/3 //加入成员接口
</span></span><span class=line><span class=cl>[S-eth-trunk1]quit
</span></span><span class=line><span class=cl># 或者在接口视图下加入 eth-trunk
</span></span><span class=line><span class=cl>[S]interface g0/0/1
</span></span><span class=line><span class=cl>[S-g0/0/1]eth-trunk 1
</span></span></code></pre></div><h3 id=认证-1>认证</h3><p>参考路由器配置</p><h3 id=stp>STP</h3><p>（1）mstp</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl>[S]stp mode mstp
</span></span><span class=line><span class=cl># 生成树域配置
</span></span><span class=line><span class=cl>[S]stp region-configuration
</span></span><span class=line><span class=cl>[S-mst-region]region-name huawei
</span></span><span class=line><span class=cl>[S-mst-region]revision-level 1
</span></span><span class=line><span class=cl># 配置实例绑定 vlan
</span></span><span class=line><span class=cl>[S-mst-region]instance 1 vlan 10
</span></span><span class=line><span class=cl>[S-mst-region]instance 2 vlan 20
</span></span><span class=line><span class=cl>[S-mst-region]active region-configuration
</span></span><span class=line><span class=cl># 配置根桥和备份根桥
</span></span><span class=line><span class=cl># 方法一（推荐配置）
</span></span><span class=line><span class=cl>[S]stp instance 1 root primary
</span></span><span class=line><span class=cl>[S]stp instance 2 root secondary
</span></span><span class=line><span class=cl># 方法二
</span></span><span class=line><span class=cl>[S]stp instance 1 priority 0
</span></span><span class=line><span class=cl>[S]stp instance 2 priority 4096
</span></span></code></pre></div><p>⚠️ <strong>交换机配置路由协议互通的三层 vlanif 接口所属 vlan 下的二层接口请关闭 STP 功能，以免端口被阻塞影响路由协议邻居建立</strong> ⚠️</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl>[S]int g0/0/3
</span></span><span class=line><span class=cl>[S-g0/0/3]undo stp enable <span class=p>|</span> stp disable //两条命令都可以，任选其一
</span></span></code></pre></div><h3 id=vlan>VLAN</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl># 创建 vlan
</span></span><span class=line><span class=cl>[S]vlan batch 100 200 1000
</span></span></code></pre></div><h3 id=trunk>TRUNK</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl># 配置 trunk 口
</span></span><span class=line><span class=cl>[S]int g0/0/1
</span></span><span class=line><span class=cl>[S-g0/0/1]port link-type trunk
</span></span><span class=line><span class=cl>[S-g0/0/1]port trunk allow-pass vlan all
</span></span><span class=line><span class=cl>[S-g0/0/1]int g0/0/2
</span></span><span class=line><span class=cl>[S-g0/0/2]port link-type trunk
</span></span><span class=line><span class=cl>[S-g0/0/2]port trunk allow-pass vlan all
</span></span><span class=line><span class=cl># 配置 access 口
</span></span><span class=line><span class=cl>[S-g0/0/2]int g0/0/3
</span></span><span class=line><span class=cl>[S-g0/0/3]port link-type access
</span></span><span class=line><span class=cl>[S-g0/0/3]port default vlan 10
</span></span><span class=line><span class=cl>[S-g0/0/3]int g0/0/4
</span></span><span class=line><span class=cl>[S-g0/0/4]port link-type access
</span></span><span class=line><span class=cl>[S-g0/0/4]port default vlan 20
</span></span></code></pre></div><h3 id=vrrp>VRRP</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl># 在 vlanif 接口下配置
</span></span><span class=line><span class=cl>[S]int vlanif 10
</span></span><span class=line><span class=cl>[S-vlanif10]vrrp vrid 1 virtual-ip 192.168.1 254
</span></span><span class=line><span class=cl>[S-vlanif10]vrrp vrid 1 priority 120 //设置 vrrp 优先级（默认 100，越高越优先）
</span></span><span class=line><span class=cl>[S-vlanif10]vrrp vrid 1 preempt-mode timer delay 20 // 主虚拟路由器设置抢占
</span></span><span class=line><span class=cl>延时为 20s
</span></span></code></pre></div><h3 id=ospf-1>OSPF</h3><p>三层交换机参考路由器配置</p><h3 id=组播-1>组播</h3><p>（1）三层交换机参考路由器配置
（2）二层交换机需启用 igmp-snooping</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl># 全局启用 igmp-snooping
</span></span><span class=line><span class=cl>[S]igmp-snooping enable
</span></span><span class=line><span class=cl># vlan 下启用 igmp-snooping
</span></span><span class=line><span class=cl>[S]vlan 10
</span></span><span class=line><span class=cl>[S-vlan10]igmp-snooping enable
</span></span><span class=line><span class=cl>[S-vlan10]vlan 20
</span></span><span class=line><span class=cl>[S-vlan20]igmp-snooping enable
</span></span></code></pre></div><h3 id=配置文件备份-1>配置文件备份</h3><p>参考路由器配置</p><h2 id=访问控制>访问控制</h2><h3 id=vlan-的隔离>VLAN 的隔离</h3><p>（1）端口隔离</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl># 配置接口 g1/0/1 和 g1/0/2 的端口隔离功能，实现两个接口之间的二层数据隔离，
</span></span><span class=line><span class=cl>三层数据互通
</span></span><span class=line><span class=cl>[S]port-isolate mode l2
</span></span><span class=line><span class=cl>[S]int g1/0/1
</span></span><span class=line><span class=cl>[S-g1/0/1]port-isolate enable group 1
</span></span><span class=line><span class=cl>[S-g1/0/1]int g1/0/2
</span></span><span class=line><span class=cl>[S-g1/0/2]port-isolate enable group 1
</span></span></code></pre></div><p>（2）Mux VLAN</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl># 创建 vlan
</span></span><span class=line><span class=cl>[S]vlan batch 2 3 4
</span></span><span class=line><span class=cl>[S]vlan 2
</span></span><span class=line><span class=cl># 配置该 vlan 为 mux vlan，即 principal vlan
</span></span><span class=line><span class=cl>[S-vlan2]mux-vlan
</span></span><span class=line><span class=cl># 互通型 vlan
</span></span><span class=line><span class=cl>[S-vlan2]subordinate group 3
</span></span><span class=line><span class=cl># 隔离型 vlan
</span></span><span class=line><span class=cl>[S-vlan2]subordinate separate 4
</span></span><span class=line><span class=cl># 使能接口的 mux vlan 功能
</span></span><span class=line><span class=cl>[S]int g0/0/1
</span></span><span class=line><span class=cl>[S-g0/0/1]port link-type access
</span></span><span class=line><span class=cl>[S-g0/0/1]port default vlan 3
</span></span><span class=line><span class=cl>[S-g0/0/1]port mux-vlan enable vlan 3
</span></span></code></pre></div><h3 id=acl-访问控制>ACL 访问控制</h3><p><strong>做流量过滤时，基本 ACL 离目的近，高级 ACL 离源进</strong>
（1）traffice-filter 做流量过滤</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl># VLAN 下做 traffic-filter
</span></span><span class=line><span class=cl>[S]acl 3000
</span></span><span class=line><span class=cl>[S-acl-adv-3000]rule permit tcp destination 192.168.2.1 0 
</span></span><span class=line><span class=cl>destination-port eq 21
</span></span><span class=line><span class=cl>[S-acl-adv-3000]rule deny ip destination 192.168.2.0 
</span></span><span class=line><span class=cl>0.0.0.255
</span></span><span class=line><span class=cl>[S-acl-adv-3000]quit
</span></span><span class=line><span class=cl>[S]traffic-filter vlan 10 inbound acl 3000
</span></span><span class=line><span class=cl># 接口视图下做 traffic-filter
</span></span><span class=line><span class=cl>[S]acl 3001
</span></span><span class=line><span class=cl>[S-acl-adv-3001]rule deny tcp source 192.168.1.1 0 
</span></span><span class=line><span class=cl>destination 192.168.3.1 0 destination-port eq 21
</span></span><span class=line><span class=cl>[S-acl-adv-30001]quit
</span></span><span class=line><span class=cl>[S]int g0/0/3
</span></span><span class=line><span class=cl>[S-g0/0/3]traffic-filter inbound acl 3001
</span></span></code></pre></div><p>（2）traffic-policy 流策略做流量过滤（作为没有 traffic-filter 命令的备份）
<img src=https://alphapenng-1305651397.cos.ap-shanghai.myqcloud.com/uPic/2021_08_29_%E9%80%9A%E8%BF%87%E6%B5%81%E7%AD%96%E7%95%A5%E5%AE%9E%E7%8E%B0VLAN%E4%B8%89%E5%B1%82%E9%9A%94%E7%A6%BB.png alt=通过流策略实现VLAN三层隔离></p><h2 id=接入控制>接入控制</h2><h3 id=交换机上-ipmac端口绑定>交换机上 IP、MAC、端口绑定</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl># 首先查看终端 mac 地址并复制
</span></span><span class=line><span class=cl>[S]dis mac-address
</span></span><span class=line><span class=cl># 然后配置绑定
</span></span><span class=line><span class=cl>[S] user-bind static ip-address 192.168.100.1 mac-address 5489-9885-723a 
</span></span><span class=line><span class=cl>interface g0/0/1 
</span></span><span class=line><span class=cl># 最后在端口激活检查
</span></span><span class=line><span class=cl>[s]int g0/0/1
</span></span><span class=line><span class=cl>[S-g0/0/1]ip source check user-bind enable
</span></span></code></pre></div><h2 id=流量采集>流量采集</h2><h3 id=交换机镜像-wireshark-采集>交换机镜像 Wireshark 采集</h3><p>（1）本地镜像配置</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl># 配置观察口
</span></span><span class=line><span class=cl>[S]observe-port 1 int g0/0/24
</span></span><span class=line><span class=cl># 配置一个镜像口
</span></span><span class=line><span class=cl>[S]interface g0/0/1
</span></span><span class=line><span class=cl>[S-g0/0/1]port-mirroring to observe-port 1 [inbound（入向）<span class=p>|</span> outbound（出向）
</span></span><span class=line><span class=cl><span class=p>|</span> both（双向）]
</span></span><span class=line><span class=cl># 配置多个镜像口
</span></span><span class=line><span class=cl>[S]interface range g0/0/1 to 0/0/23
</span></span><span class=line><span class=cl>[S-range0/0/1-0/0/23]port-mirroring to observe-port 1 [inbound <span class=p>|</span> outbound 
</span></span><span class=line><span class=cl><span class=p>|</span> both]
</span></span></code></pre></div><p>（2） Wireshark 采集
<img src=https://alphapenng-1305651397.cos.ap-shanghai.myqcloud.com/uPic/2021_08_29_Wireshark%E6%98%BE%E7%A4%BA%E8%BF%87%E6%BB%A4%E5%99%A8%E8%A1%A8%E8%BE%BE%E5%BC%8F.png alt=Wireshark显示过滤器表达式></p><h2 id=维护与排障>维护与排障</h2><ul><li>配置之前先检查设备各硬件及板卡指示灯是否正常，有无告警；再确认路由器主管理板是哪块，防止插错管理口；线缆连接完毕后请检查相应端口指示灯是否点亮。</li><li>NE20 系列路由器在用户视图下键入 sys 命令进入系统视图后，配置命令并不立即生效，如需生效需键入 commit 命令；如要在用户视图下进入系统配置立即生效模式，请键入 <code>system-view immediately</code></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl><span class=p>&lt;</span>R<span class=p>&gt;</span>sys 
</span></span><span class=line><span class=cl>[~R]sysna huawei //此条命令并不立即生效
</span></span><span class=line><span class=cl>[~R]commit //执行 commit 才会生效
</span></span><span class=line><span class=cl><span class=p>&lt;</span>R<span class=p>&gt;</span>sys im //进入立即生效模式
</span></span><span class=line><span class=cl>[R]sysna huawei //命令在键入后即生效
</span></span></code></pre></div><ol><li><p>配置信息查看</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl>[R]dis cur con [aaa <span class=p>|</span> bgp <span class=p>|</span> ...] //某项配置信息查看
</span></span><span class=line><span class=cl>[R]dis cur <span class=p>|</span> include <span class=p>&lt;</span>关键字<span class=p>&gt;</span> //按关键字查看配置信息
</span></span></code></pre></div></li><li><p>接口信息查看</p><p>（1）接口状态概要信息查看</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl>[R]dis interface brief
</span></span></code></pre></div><p>（2）三层接口概要信息查看</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl>[R]dis ip interface brief
</span></span></code></pre></div><p>（3）二层接口所属 VLAN 信息查看</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl>[R]dis port vlan
</span></span></code></pre></div><p>（4）E1-F 接口</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl>[R]display fe1 serial 2/0/0 //查看 E1-F 接口的基本配置信息和告警情况
</span></span><span class=line><span class=cl>[R]dis interface serial 2/0/0 //查看 E1-F 接口的状态及统计信息
</span></span><span class=line><span class=cl># 配置环回检测功能
</span></span><span class=line><span class=cl>[R]int serial 2/0/0
</span></span><span class=line><span class=cl>[R-serial2/0/0]fe1 loopback [local <span class=p>|</span> payload <span class=p>|</span> remote] //配置检测方式为本端、
</span></span><span class=line><span class=cl>载荷和远端
</span></span><span class=line><span class=cl>[R]display interface serial 2/0/0 //查看本端/对端设备的 Serial 接口的物理状态
</span></span><span class=line><span class=cl>（current state）是否为 UP
</span></span><span class=line><span class=cl><span class=p>&lt;</span>R<span class=p>&gt;</span>reset counters interface serial 2/0/0 //清除 E1-F 接口生成的串口上的统计
</span></span><span class=line><span class=cl>信息
</span></span></code></pre></div><p>（5）<strong>Pos 接口物理层不 up</strong></p><ul><li>检查对接的两侧设备接口上的光纤模块是否匹配</li><li>检查故障端口做环回测试后是否 up</li><li>做该环回的目的是<code>检查本端单板是否正常</code>，如果 loopback local 后仍然无法 up，则可以确定是本端接收单板的故障导致，尝试更换子卡。</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl>[HUAWEI-Pos0/1/0] loopback local
</span></span><span class=line><span class=cl>[HUAWEI-Pos0/1/0] dlisplay this interface
</span></span><span class=line><span class=cl>Pos0/1/0 current state: UP 备注：物理状态的显示结果
</span></span><span class=line><span class=cl>Line protocol current state： DOWN
</span></span><span class=line><span class=cl>Link quality grade:--
</span></span><span class=line><span class=cl>Description:HUAWEI, Pos0/1/0 Interface
</span></span><span class=line><span class=cl>Route Port, The Maximum Transmit Unit is 4470, Hold time
</span></span><span class=line><span class=cl>Internet protocol processing: disabled
</span></span><span class=line><span class=cl>Link layer protocol is PPP
</span></span><span class=line><span class=cl>LCP initial
</span></span><span class=line><span class=cl>The Vendor PN is FTLF8519P2BNL-HW
</span></span><span class=line><span class=cl>The Vendor Name is FINISAR CORP.
</span></span><span class=line><span class=cl>Port Bw: 2.5G, Transceiver max Bw:2.5G, Transceiver Mo
</span></span><span class=line><span class=cl>WaveLength: 850nm, Transmission Distance: 500m
</span></span><span class=line><span class=cl>Physical layer is Packet Over SDH
</span></span><span class=line><span class=cl>Scramble enabled, clock master, CRC-32, loopback: local
</span></span><span class=line><span class=cl>Flag J0 <span class=s2>&#34;NetEngine  &#34;</span>
</span></span><span class=line><span class=cl>Flag J1 <span class=s2>&#34;NetEngine  &#34;</span> 
</span></span><span class=line><span class=cl>Flag C2 22(0x16)
</span></span><span class=line><span class=cl>Last physical up time: 2016-01-24 11:10:05
</span></span><span class=line><span class=cl>Last physical down time: 2016-01-24 10:47:00
</span></span><span class=line><span class=cl>Current System time: 2016-01-24 11:10:14
</span></span></code></pre></div><ul><li><p>检查接口上是否有联动 down 的告警</p><ul><li><p>检查接口上的 SDH 告警</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl><span class=p>&lt;</span>HUAWEl<span class=p>&gt;</span> display pos interface pos0/1/0
</span></span><span class=line><span class=cl>Pos0/1/0 current state:DOWN
</span></span><span class=line><span class=cl>Line protocol current state:DOWN
</span></span><span class=line><span class=cl>Physical layer is Packet Over SDH
</span></span><span class=line><span class=cl>Scramble enabled, clock master, CRC-32, loopback: none
</span></span><span class=line><span class=cl>Flag J0 <span class=s2>&#34;NetEngine&#34;</span>
</span></span><span class=line><span class=cl>Flag J1 <span class=s2>&#34;NetEngine&#34;</span>
</span></span><span class=line><span class=cl>Flag C2 22(0x16)
</span></span><span class=line><span class=cl>SDH alarm: //备注：下面3行表示sdh告警，当前有LOS告警
</span></span><span class=line><span class=cl>section layer: LOS
</span></span><span class=line><span class=cl>line layer: none
</span></span><span class=line><span class=cl><span class=k>path</span> layer: none
</span></span><span class=line><span class=cl>SDH error: //备注：下面3行表示sdh误码
</span></span><span class=line><span class=cl>section layer: B1 0
</span></span><span class=line><span class=cl>line layer: B2 0 REI 0
</span></span><span class=line><span class=cl><span class=k>path</span> layer: B3 0 REI 0
</span></span><span class=line><span class=cl># POS接口默认联动down的SDH告警是LOS/LOF/LAIS，很多设备还有再配置LRDI/PRDI联动down，
</span></span><span class=line><span class=cl>可以通过查看接口上的配置确认。
</span></span><span class=line><span class=cl><span class=p>&lt;</span>HUAWEI<span class=p>&gt;</span> display current-configuration interface pos0/1/1
</span></span><span class=line><span class=cl>#
</span></span><span class=line><span class=cl>interface Pos0/1/1
</span></span><span class=line><span class=cl>link-protocol hdlc
</span></span><span class=line><span class=cl>undo shutdown
</span></span><span class=line><span class=cl>transmission-alarm down lais lof los lrdi pais prdi 
</span></span><span class=line><span class=cl>#
</span></span><span class=line><span class=cl>return
</span></span></code></pre></div></li><li><p>按照以上步骤中命令行回显的 SDH 告警，分别进行检查。
<strong>LOS告警可能的故障原因：</strong></p><ol><li>排查路由器至传输设备间的链路，可以用光功率计测量光功率，必要时可以进行更换或使用正常的链路进行交叉测试。</li><li>路由器与传输设备之间的尾纤错联，使不同速率级别的光口互连。</li><li>传输设备上游无光，且传输设备配置了激光器关断，导致未向路由器发光，需要检查传输设备。</li><li>可以排查一下传输设备上有无LOS，LOF等告警。</li></ol><p><strong>LOF告警可能的故障原因：</strong></p><ol><li>排查路由器至传输设备间的链路质量。</li><li>排查传输设备上的告警，传输网络中有线路故障或单板故障，导致传输波分设备与路由器连接的单板收上游无光或收上游有LOF告警，从而向下游的路由器设备发送带有LOF告警的信号。</li></ol><p><strong>LAIS/PAIS告警可能的故障原因：</strong></p><ol><li>路由器POS口因为LOS、OOF或LOF告警，而产生LAIS/PAIS，这种情况不用关注LAIS和PAIS告警。</li><li>单独的LAIS/PAIS告警，一般是传输设备发送过来的，需要排查传输设备。</li></ol><p><strong>LRDI/PRID告警可能的故障原因：</strong></p><ol><li>对端路由器连接传输设备的端口，上报了LOS、 LOF、或LAIS/PAIS告警，并且由传输设备发向路由器的单方向尾纤链路良好的情况下，回告给本端路由器POS口LRDI/PRID告警指示。也就是说这是一种远端设备故障指示的告警，需要检查对端路由器不up的原因。</li></ol></li></ul></li><li><p>在故障端口光模块上做尾纤自环测试后检查是否 up</p><ul><li>采取使用尾纤加固定光衰（保证输入光功率不超过POS口上限，光模块传输距离在10KM及以下的无需光衰）对POS口进行端口内环回操作。环回前，应先测量本POS端口的输出功率，选择合适的固定光衰。
环回后，先观察端口上的接收光功率是否在正常范围内，然后查看SDH告警是否消失，物理状态是否up。如果up，则说明是传输问题，如果不up，说明是本端故障，可以尝试更换光模块。
查询接口光模块传输距离，光功率及光功率门限的命令：</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl><span class=p>&lt;</span>HUAWEl<span class=p>&gt;</span> display interface Pos 0/1/0
</span></span><span class=line><span class=cl>Pos0/1/0 current state: DOWN //备注：物理状态的显示    
</span></span><span class=line><span class=cl>Line protocol current state : DOWN
</span></span><span class=line><span class=cl>Link quality grade :--
</span></span><span class=line><span class=cl>Description:HUAWEl, Pos0/1/0 Interface
</span></span><span class=line><span class=cl>Route Port,The Maximum Transmit Unit is 4470, Hold time
</span></span><span class=line><span class=cl>Internet protocol processing : disabled
</span></span><span class=line><span class=cl>Link layer protocol is PPP
</span></span><span class=line><span class=cl>LCP initial
</span></span><span class=line><span class=cl>The Vendor PN is FTLF8519P2BNL-HW
</span></span><span class=line><span class=cl>The Vendor Name is FINISAR CORP.
</span></span><span class=line><span class=cl>Port BW: 2.5G, Transceiver max BW: 1G, Transceiver Moc
</span></span><span class=line><span class=cl>WaveLength: 850nm, Transmission Distance: 500m 
</span></span><span class=line><span class=cl>Rx Power: -29.59dBm, Warning range:[-16.99, 0.00ldBm
</span></span><span class=line><span class=cl>Tx Power: -5.44dBm, Warning range: [-9.50, 0.00]dBm
</span></span><span class=line><span class=cl>Physical layer is Packet Over SDH
</span></span><span class=line><span class=cl># 说明：
</span></span><span class=line><span class=cl># 前面那个Rx Power是当前的接收功率，后面那个中括号
</span></span><span class=line><span class=cl># 内的范围是正常的功率范围，在范围之外的都不正常。
</span></span><span class=line><span class=cl># TX Power是当前的发送光功率，后面括号中的范围是正
</span></span><span class=line><span class=cl># 常的发送光功率范围。
</span></span></code></pre></div></li><li><p>收集信息寻求技术支持</p></li></ul><p>（6）<strong>Pos 接口检查光模块工作状态是否正常</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl><span class=p>&lt;</span>HUAWEI<span class=p>&gt;</span> display transceiver interface GigabitEthernet 2/0/3 verbose 
</span></span><span class=line><span class=cl>GigabitEthernet2/0/3 transceiver information: 
</span></span><span class=line><span class=cl>------------------------------------------------------------- 
</span></span><span class=line><span class=cl>Common information: 
</span></span><span class=line><span class=cl>Transceiver Type:1000_BASE_SX_SFP 
</span></span><span class=line><span class=cl>Connector Type:LC 
</span></span><span class=line><span class=cl>Wavelength(nm):850 
</span></span><span class=line><span class=cl>Transfer Distance(m):500(50um),300(62.5um) 
</span></span><span class=line><span class=cl>Digital Diagnostic Monitoring:YES 
</span></span><span class=line><span class=cl>Vendor Name:HUAWEI 
</span></span><span class=line><span class=cl>Vendor Part Number:02315204 
</span></span><span class=line><span class=cl>Ordering Name: 
</span></span><span class=line><span class=cl>------------------------------------------------------------- 
</span></span><span class=line><span class=cl>Manufacture information: 
</span></span><span class=line><span class=cl>Manu. Serial Number:NSK1NNV 
</span></span><span class=line><span class=cl>Manufacturing Date:2014-11-09 
</span></span><span class=line><span class=cl>Vendor Name:HUAWEI 
</span></span><span class=line><span class=cl>------------------------------------------------------------- 
</span></span><span class=line><span class=cl>Alarm information: 
</span></span><span class=line><span class=cl>------------------------------------------------------------- 
</span></span><span class=line><span class=cl>Diagnostic information:
</span></span><span class=line><span class=cl>Temperature(°C):39
</span></span><span class=line><span class=cl>Voltage(V):3.32
</span></span><span class=line><span class=cl>Bias Current(mA):6.91 //电流值
</span></span><span class=line><span class=cl>Bias High Threshold(mA):33.34
</span></span><span class=line><span class=cl>Bias LowThreshold(mA):1.67
</span></span><span class=line><span class=cl>Current Rx Power(dBM):-4.59 //接口收光功率
</span></span><span class=line><span class=cl>Default Rx Power High Threshold(dBM):0.00
</span></span><span class=line><span class=cl>Default Rx Power LowThreshold(dBM):-16.99
</span></span><span class=line><span class=cl>Current Tx Power(dBM):-5.10 //接口发光功率
</span></span><span class=line><span class=cl>Default Tx Power High Threshold(dBM):0.00
</span></span><span class=line><span class=cl>Default Tx Power LowThreshold(dBM):-12.50
</span></span><span class=line><span class=cl>User Set Rx Power High Threshold(dBM) :0.00
</span></span><span class=line><span class=cl>Jser Set Rx Power Low Threshold(dBM):-16.99
</span></span><span class=line><span class=cl>User Set Tx Power High Threshold(dBM) :0.00
</span></span><span class=line><span class=cl>User Set Tx Power Low Threshold(dBM):-12.50
</span></span></code></pre></div><p>（7）<strong>网口检查对接网线是否正常</strong></p><ul><li>对于 GE 电口，如果使用低于五类线的网线将不能够使 GE 电口以 1000M 速率 Up，所有电口对接，均推荐使用五类线以上规格的网线对接</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl><span class=p>&lt;</span>HUAWEI<span class=p>&gt;</span> system-view
</span></span><span class=line><span class=cl>[HUAWEll interface gigabitethernet 0/0/1
</span></span><span class=line><span class=cl>[HUAWEI-GigabitEthernet0/0/1] virtual-cable-test
</span></span><span class=line><span class=cl>Pair A length: 1meter(s)
</span></span><span class=line><span class=cl>Pair B Iength: 1meter(s)
</span></span><span class=line><span class=cl>Pair C length: 1meter(s)
</span></span><span class=line><span class=cl>Pair D length: 1meter(s)
</span></span><span class=line><span class=cl>Pair A state: Ok //回显中“Pair state”为“OK”表示正常；如果为其他状态，建议更换网线测试
</span></span><span class=line><span class=cl>Pair B state: Ok
</span></span><span class=line><span class=cl>Pair C state: Ok
</span></span><span class=line><span class=cl>Pair D state: Ok
</span></span></code></pre></div></li><li><p>VLAN 信息查看</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl>[R]dis vlan summary
</span></span></code></pre></div></li><li><p>STP 信息查看</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl>[R]dis stp region-configuration //生成树域查看
</span></span><span class=line><span class=cl>[R]dis stp instance 1//生成树信息查看
</span></span><span class=line><span class=cl>[R]dis stp instance 1 brief //生成树概要信息查看
</span></span></code></pre></div></li><li><p>VRRP 信息查看</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl>[R]dis vrrp brief
</span></span></code></pre></div></li><li><p>OSPF 信息查看</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl>[R]dis ospf interface
</span></span><span class=line><span class=cl>[R]dis ospf peer bri
</span></span><span class=line><span class=cl>[R]dis ospf lsdb [router <span class=p>|</span> network <span class=p>|</span> summary <span class=p>|</span> asbr <span class=p>|</span> ase <span class=p>|</span> nssa] //查看
</span></span><span class=line><span class=cl>相应类型的 LSA 的详细信息
</span></span><span class=line><span class=cl>[R]dis ospf routing-table 
</span></span></code></pre></div></li><li><p>BGP 信息查看</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl>[R]dis bgp peer
</span></span><span class=line><span class=cl>[R]dis bgp routing-table
</span></span></code></pre></div></li><li><p>组播信息查看</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl># 三层设备
</span></span><span class=line><span class=cl>[R]dis multicast routing-table
</span></span><span class=line><span class=cl>[R]dis pim routing-table
</span></span><span class=line><span class=cl>[R]dis pim interface
</span></span><span class=line><span class=cl>[R]dis pim neighbor
</span></span><span class=line><span class=cl>[R]dis pim bsr-info
</span></span><span class=line><span class=cl>[R]dis pim rp-info <span class=p>&lt;</span> 组播地址 &gt;
</span></span><span class=line><span class=cl>[R]dis igmp group
</span></span><span class=line><span class=cl>[R]dis igmp interface
</span></span><span class=line><span class=cl># 二层设备
</span></span><span class=line><span class=cl>[S]dis igmp-snooping router-port vlan <span class=p>&lt;</span>vlan-id&gt;
</span></span><span class=line><span class=cl>[S]dis igmp-snooping port-info vlan <span class=p>&lt;</span>vlan-id&gt;
</span></span><span class=line><span class=cl>[S]dis l2-multicast forwarding-table vlan <span class=p>&lt;</span>vlan-id&gt;
</span></span></code></pre></div></li><li><p>VPN 信息查看</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl># 查看 LDP 会话建立情况
</span></span><span class=line><span class=cl>[R]dis mpls ldp session
</span></span><span class=line><span class=cl>[R]dis mpls lsp
</span></span><span class=line><span class=cl># 查看本地 VPN 实例路由
</span></span><span class=line><span class=cl>[R]dis ip routing-table vpn-instance vpna
</span></span><span class=line><span class=cl># 查看 MP-BGP 路由
</span></span><span class=line><span class=cl>[R]dis bgp vpnv4 vpn-instance vpna routing-table
</span></span></code></pre></div></li></ol><h2 id=附录>附录</h2><ol><li><p>华为路由协议优先级
<img src=https://alphapenng-1305651397.cos.ap-shanghai.myqcloud.com/uPic/2021_08_29_16291859715076.png alt="huawei 路由协议的优先级"></p></li><li><p>理解华为 BGP 路由表
<img src=https://alphapenng-1305651397.cos.ap-shanghai.myqcloud.com/uPic/2021_08_29_%E7%90%86%E8%A7%A3BGP%E8%B7%AF%E7%94%B1%E8%A1%A8.png alt=理解BGP路由表></p></li><li><p>BGP 路由协议 13 条选路原则
<img src=https://alphapenng-1305651397.cos.ap-shanghai.myqcloud.com/uPic/2021_08_29_BGP13%E6%9D%A1%E9%80%89%E8%B7%AF%E5%8E%9F%E5%88%99.png alt=BGP13条选路原则></p></li><li><p>IP 协议号列表
<img src=https://alphapenng-1305651397.cos.ap-shanghai.myqcloud.com/uPic/2021_08_29_IP%E5%8D%8F%E8%AE%AE%E5%8F%B7%E5%88%97%E8%A1%A8.png alt=IP协议号列表></p></li><li><p>TCP/UDP 端口列表
<img src=https://alphapenng-1305651397.cos.ap-shanghai.myqcloud.com/uPic/2021_08_29_TCPUDP%E7%AB%AF%E5%8F%A3%E5%88%97%E8%A1%A80-1023.png alt=TCPUDP端口列表0-1023></p><p><img src=https://alphapenng-1305651397.cos.ap-shanghai.myqcloud.com/uPic/2021_08_29_TCPUDP%E7%AB%AF%E5%8F%A31024-65535.png alt=TCPUDP端口1024-65535></p></li><li><p>Windows.MSC命令
<img src=https://alphapenng-1305651397.cos.ap-shanghai.myqcloud.com/uPic/2021_08_29_Windows_msc%E5%91%BD%E4%BB%A4.png alt=Windows_msc命令></p></li><li><p>Windows7 防火墙设置
<img src=https://alphapenng-1305651397.cos.ap-shanghai.myqcloud.com/uPic/2021_09_29_windows7%E9%98%B2%E7%81%AB%E5%A2%99%E8%AE%BE%E7%BD%AE%E7%AE%80%E4%BB%8B.png alt="Windows7 防火墙设置简介">
<img src=https://alphapenng-1305651397.cos.ap-shanghai.myqcloud.com/uPic/2021_09_29_windows7%E9%98%B2%E7%81%AB%E5%A2%99%E8%AE%BE%E7%BD%AE%E8%AF%A6%E8%A7%A3%EF%BC%88%E4%B8%80%EF%BC%89.png alt="Windows7 防火墙设置详解（一）">
<img src=https://alphapenng-1305651397.cos.ap-shanghai.myqcloud.com/uPic/2021_09_29_windows7%E9%98%B2%E7%81%AB%E5%A2%99%E8%AE%BE%E7%BD%AE%E8%AF%A6%E8%A7%A3%EF%BC%88%E4%BA%8C%EF%BC%89.png alt="Windows7 防火墙设置详解（二）"></p></li></ol></article><h2>相关文章</h2><dl class=row></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl><div align=center><div class=comment-underline></div></div><br><div id=cusdis_thread data-host=https://cusdis.com data-app-id=34a447f4-be9d-4312-b87b-2c5bfcfc7658 data-page-id=6e00b1a5960e332e7928a03da03062ab data-page-url=https://alphapenng.github.io/zh-cn/2022/08/03/%E5%8D%8E%E4%B8%BA%E8%B7%AF%E7%94%B1%E4%BA%A4%E6%8D%A2%E8%AE%BE%E5%A4%87%E5%91%BD%E4%BB%A4%E6%89%8B%E5%86%8C/ data-page-title=华为路由交换设备命令手册></div><script defer src=https://cusdis.com/js/widget/lang/zh-cn.js></script>
<script async defer src=https://cusdis.com/js/cusdis.es.js></script></div></main><div class="footer gradient-2"><div class="container footer-container"><div class=row><div class="col-xs-4 col-sm-3 col-md-3 col-lg-3"><div class=footer-title>网站地图</div><ul class=list-unstyled><li><a href=https://alphapenng.github.io/zh-cn/tags/>标签</a></li><li><a href=https://alphapenng.github.io/zh-cn/categories/>分类</a></li><li><a rel=alternate type=application/rss+xml href=https://alphapenng.github.io/zh-cn/index.xml><i class="fas fa-rss-square"></i> RSS</a></li></ul></div><div class="col-xs-4 col-sm-3 col-md-3 col-lg-3"></div><div class="col-xs-4 col-sm-3 col-md-3 col-lg-3"></div><div class="col-xs-12 col-sm-3 col-md-3 col-lg-3"><p class="pull-right text-right"><small><em>Powered by <a href=https://gohugo.io rel=noopener target=_blank>Hugo</a> - <a href=https://github.com/shaform/hugo-theme-den rel=noopener target=_blank>den</a></em></small><br><small>&copy;
alphapenng
2022 -
2023</small></p></div></div></div></div><script src=https://code.jquery.com/jquery-3.3.1.slim.min.js integrity=sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js integrity=sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49 crossorigin=anonymous></script>
<script src=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js integrity=sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy crossorigin=anonymous></script></body></html>